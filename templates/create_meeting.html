{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
    <h2>{{ legend }}</h2> <form method="POST" action="">
        {{ form.hidden_tag() }} <fieldset> <div>
                {{ form.title.label }}<br>
                {{ form.title(size=30) }}<br>
                {% if form.title.errors %}
                    {% for error in form.title.errors %}
                        <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                {% endif %}
            </div>
             <div>
                {{ form.meeting_date.label }}<br>
                {{ form.meeting_date() }}<br> {% if form.meeting_date.errors %}
                    {% for error in form.meeting_date.errors %}
                        <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                {% endif %}
            </div>
             <div>
                {{ form.attendees.label }}<br>
                {{ form.attendees(rows=3, cols=30) }}<br>
                {% if form.attendees.errors %}
                    {% for error in form.attendees.errors %}
                        <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                {% endif %}
            </div>
            <div>
                {# Display the main label for the list #}
                {{ form.agenda_items.label(class="form-label") }}<br>

                {# Container for individual item inputs #}
                <div id="agenda-items-container">
                    {# Loop through the fields within the FieldList #}
                    {% for item_field in form.agenda_items %}
                        <div class="agenda-item" style="margin-bottom: 5px;">
                            {# Render the actual input field for each item #}
                            {{ item_field(size=50, class="form-control") }}
                            {# Add a remove button placeholder - JS will handle it #}
                            <button type="button" class="remove-agenda-item" style="margin-left: 5px;">-</button>
                            {# Display errors for this specific item field #}
                            {% if item_field.errors %}
                                <div style="color: red;">
                                {% for error in item_field.errors %}
                                    <span>[{{ error }}]</span><br>
                                {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>

                {# Button to add more items - JS will handle it #}
                <button type="button" id="add-agenda-item" style="margin-top: 5px;">+ Add Agenda Item</button>
            </div>
            {# --- End: New Block for Agenda Items --- #}

            {# Keep the rendering for minutes, action_items, etc. as they were #}
             <div>
                {{ form.minutes.label }}<br>
                {{ form.minutes(rows=10, cols=30) }}<br>
                {% if form.minutes.errors %}
                    {% for error in form.minutes.errors %}
                        <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                {% endif %}
            </div>
             <div>
                {{ form.action_items.label }}<br>
                {{ form.action_items(rows=5, cols=30) }}<br>
                {% if form.action_items.errors %}
                    {% for error in form.action_items.errors %}
                        <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                {% endif %}
            </div>
        </fieldset>
        <div>
            {{ form.submit() }}
        </div>
    </form>
    <p><a href="{{ url_for('index') }}">Back to Home</a></p>

{% endblock %}
